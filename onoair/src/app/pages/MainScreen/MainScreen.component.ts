import { Component } from '@angular/core';
import { Router } from '@angular/router';
import { MatCardModule } from '@angular/material/card';
import { CommonModule } from '@angular/common';
import { MatTableModule } from '@angular/material/table';
import { MatButtonModule } from '@angular/material/button';
import { SharedService } from '../../services/shared.service';
import { FlightService } from '../../services/flight.service';

@Component({
  selector: 'app-main-screen',
  standalone: true,
  imports: [CommonModule, MatCardModule, MatTableModule, MatButtonModule], // Import CommonModule for *ngFor
  templateUrl: './MainScreen.component.html',
  styleUrls: ['./MainScreen.component.css']
})
export class MainScreenComponent {
  constructor(private sharedService: SharedService, private router: Router, private flightService: FlightService) {}
  lastMinuteFlights = [
    { flightNumber: 'AA789', destination: 'Berlin', date: '25.11.2024', imageUrl: 'https://i.pinimg.com/736x/05/e4/c2/05e4c209cabc106c85cc24d4a398512c.jpg' },
    {flightNumber:'FR456', destination:'Dublin', date:'1.12.2024', 
      imageUrl: 'https://bucket-files.city-sightseeing.com/blog/2023/02/cityview-dublin-1024x683.jpg '},
    {flightNumber: 'LH123', destination: 'Paris', date: '29.11.2024', imageUrl: 'data:image/jpeg;base64,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'},
  ];

   futureFlights = [
    { flightNumber: 'LH123', origin: 'Berlin', destination: 'Paris', departure: '02.12.2024', arrival: '02.12.2024', seats: 180 },
    { flightNumber: 'FR456', origin: 'London', destination: 'Dublin', departure: '03.12.2024', arrival: '03.12.2024', seats: 150 },
    { flightNumber: 'AA789', origin: 'New York', destination: 'Berlin', departure: '04.12.2024', arrival: '04.12.2024', seats: 200 }
  ];

  displayedColumns: string[] = ['flightNumber', 'origin', 'destination', 'departure', 'arrival', 'seats', 'actions'];

   // Method to transfer flight details and navigate to My Bookings
   bookFlight(flightNumber: string): void {
  // Fetch flight details from the FlightService
  const flight = this.flightService.get(flightNumber);

  if (!flight) {
    alert('Flight not found. Please select a valid flight.');
    return;
  }

  // Create a new booking object using flight information directly from FlightService
  const booking = {
    bookingCode: `BOOK${Math.floor(Math.random() * 10000)}`, // Generate a unique booking code
    flightNumber: flight.flightNumber,
    origin: flight.origin,
    destination: flight.destination,
    numberOfPassengers: flight.passengerNames.length, // Assuming total seats represent passengers
    passengerNames: flight.passengerNames,
    passportNumbers: flight.passportNumbers,
    departure: flight.departure,
    arrival: flight.arrival,
  };

  // Add booking to SharedService
  this.sharedService.setSelectedFlight(booking);

  // Navigate to My Bookings page
  this.router.navigate(['/MyBookings']);
}
  
}
